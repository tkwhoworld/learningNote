# 异常控制流
a0,a1,...,an
ak是某个相应的指令Ik的地址。每次从ak到ak+1的过渡称为控制转移（Control transfer)
这样的控制转移序列叫控制流（flow of control)
异常控制流（ECF Exceptional Control Flow):平滑流的突变（跳转，调用，返回）
ECF是操作系统用来实现I/O,进程和虚拟内存的基本机制
应用程序通使用一种叫做陷阱（trap)或者系统调用（system call)的ECF形式，向操作系统请求服务
比如：向磁盘写数据、从网络读取数据、创建一个新的进程、终止当前进程。都是通过程序调用系统调用来实现的
操作系统为应用程序提供强大的ECF机制，用来创建新进程、等待进程终止、通知其他进程系统中的异常事件
以及检测和相应这些事件
ECF是实现并发的基本机制
## 异常
#### 异常是异常控制流的一种形式，它一部分有硬件实现，一部分由操作系统实现。
异常（exception）就是控制流中的突变，用来响应处理器状态中的某些变化。
#### 在任何情况下，当处理器检测到有事件发生时，它就会通过一张叫做异常表（exception table)的跳转表。进行一个间接过程
调用（异常），到一个专门设计用来处理这类事件的操作系统子程序（异常处理程序 exception handler）.当异常处理程序完成处理后，根据引起异常的
事件的类型，会发生一下3种情况的一种：
#### 处理程序将控制返回给当前指令Icurr，即当前事件发生时正在执行的指令
#### 处理程序将控制返回给Inext，如果没有发生异常将执会执行的下一条指令
#### 处理程序终止被中断的程序
### 异常处理
系统中可能的每种类型的异常都分配了一个唯一的非负整数的异常号（exception number)
异常类似于过程调用，但又一些重要的不同之处
（过程调用）
#### 过程调用时，在跳转到处理程序之前，处理器将返回地址压入栈中。
#### 处理器也把一些额外的处理器状态压入到栈里，在处理程序返回时，重新开始执行被中断的程序也会需要这些状态
#### 如果控制程序转移到内核，所有这些项目都被压到内核栈中
#### 异常处理程序运行在内核模式下，它们对所有的系统资源都有完全的访问权限

## 进程
异常是运行操作系统内核提供进程（process）概念的基本构造块。
进程的经典定义：一个执行中程序的实例，系统中的每个程序都运行在某个进程的上下文（context）中.
进程提供给应用程序的关键抽象:
一个独立的逻辑控制流，它提供一个假象，好像我们的程序独占地使用处理器
一个私有的地址空间，它提供一个假象，好像我们的程序独占地使用内存系统。
